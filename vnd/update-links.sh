#!/bin/sh

# Repository root
ROOTDIR=$( cd -- "$( dirname -- "$0" )/.." &> /dev/null && pwd )

# Convenience functions
checkerror() {
    if [ "$1" != 0 ]
    then
        printf "%s - Error %s\n" "$2" "$1" >&2
        exit "$1"
    fi
}

# Check for dependencies
jqpath=$(which jq)
checkerror $? "jq is not found"
sedpath=$(which sed)
checkerror $? "sed is not found"

# Below variables to replace when script is complete
OLDREV="2025-03-28-5ba7ee5"
OLDFILENAMESTD="mpv-dev-x86_64-20250328-git-5ba7ee5.7z"
OLDFILENAMEARM="mpv-dev-aarch64-20250328-git-5ba7ee5.7z"

# Get the new links
echo "Checking for updates..."
RELAPILINK="https://api.github.com/repos/zhongfly/mpv-winbuild/releases/latest"
#APIRESPONSE=$(curl -s $RELAPILINK || checkerror $? "Failed to download latest release info")
APIRESPONSE='{ "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/212788193", "assets_url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/212788193/assets", "upload_url": "https://uploads.github.com/repos/zhongfly/mpv-winbuild/releases/212788193/assets{?name,label}", "html_url": "https://github.com/zhongfly/mpv-winbuild/releases/tag/2025-04-16-4697f7c", "id": 212788193, "author": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "node_id": "RE_kwDOGJR1V84MruPh", "tag_name": "2025-04-16-4697f7c", "target_commitish": "version", "name": "2025-04-16 12:18", "draft": false, "prerelease": false, "created_at": "2025-04-16T12:18:59Z", "published_at": "2025-04-16T12:19:01Z", "assets": [ { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900096", "id": 246900096, "node_id": "RA_kwDOGJR1V84Ot2WA", "name": "ffmpeg-aarch64-git-afe6c1238.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 20892400, "download_count": 7, "created_at": "2025-04-16T12:19:21Z", "updated_at": "2025-04-16T12:19:22Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/ffmpeg-aarch64-git-afe6c1238.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900094", "id": 246900094, "node_id": "RA_kwDOGJR1V84Ot2V-", "name": "ffmpeg-lgpl-aarch64-git-afe6c1238.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 18207870, "download_count": 2, "created_at": "2025-04-16T12:19:20Z", "updated_at": "2025-04-16T12:19:21Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/ffmpeg-lgpl-aarch64-git-afe6c1238.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900091", "id": 246900091, "node_id": "RA_kwDOGJR1V84Ot2V7", "name": "ffmpeg-lgpl-x86_64-git-afe6c1238.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 22697543, "download_count": 4, "created_at": "2025-04-16T12:19:19Z", "updated_at": "2025-04-16T12:19:20Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/ffmpeg-lgpl-x86_64-git-afe6c1238.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900084", "id": 246900084, "node_id": "RA_kwDOGJR1V84Ot2V0", "name": "ffmpeg-lgpl-x86_64-v3-git-afe6c1238.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 23704561, "download_count": 1, "created_at": "2025-04-16T12:19:18Z", "updated_at": "2025-04-16T12:19:19Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/ffmpeg-lgpl-x86_64-v3-git-afe6c1238.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900080", "id": 246900080, "node_id": "RA_kwDOGJR1V84Ot2Vw", "name": "ffmpeg-x86_64-git-afe6c1238.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 26249753, "download_count": 18, "created_at": "2025-04-16T12:19:17Z", "updated_at": "2025-04-16T12:19:18Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/ffmpeg-x86_64-git-afe6c1238.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900072", "id": 246900072, "node_id": "RA_kwDOGJR1V84Ot2Vo", "name": "ffmpeg-x86_64-v3-git-afe6c1238.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 27398700, "download_count": 21, "created_at": "2025-04-16T12:19:15Z", "updated_at": "2025-04-16T12:19:16Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/ffmpeg-x86_64-v3-git-afe6c1238.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900061", "id": 246900061, "node_id": "RA_kwDOGJR1V84Ot2Vd", "name": "mpv-aarch64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 24596181, "download_count": 7, "created_at": "2025-04-16T12:19:14Z", "updated_at": "2025-04-16T12:19:15Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-aarch64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900046", "id": 246900046, "node_id": "RA_kwDOGJR1V84Ot2VO", "name": "mpv-debug-aarch64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 17083577, "download_count": 2, "created_at": "2025-04-16T12:19:13Z", "updated_at": "2025-04-16T12:19:14Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-debug-aarch64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900031", "id": 246900031, "node_id": "RA_kwDOGJR1V84Ot2U_", "name": "mpv-debug-x86_64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 18280692, "download_count": 4, "created_at": "2025-04-16T12:19:12Z", "updated_at": "2025-04-16T12:19:13Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-debug-x86_64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900027", "id": 246900027, "node_id": "RA_kwDOGJR1V84Ot2U7", "name": "mpv-debug-x86_64-v3-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 18231075, "download_count": 6, "created_at": "2025-04-16T12:19:11Z", "updated_at": "2025-04-16T12:19:12Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-debug-x86_64-v3-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900019", "id": 246900019, "node_id": "RA_kwDOGJR1V84Ot2Uz", "name": "mpv-dev-aarch64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 23640089, "download_count": 1, "created_at": "2025-04-16T12:19:10Z", "updated_at": "2025-04-16T12:19:11Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-dev-aarch64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900007", "id": 246900007, "node_id": "RA_kwDOGJR1V84Ot2Un", "name": "mpv-dev-lgpl-aarch64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 20620988, "download_count": 1, "created_at": "2025-04-16T12:19:09Z", "updated_at": "2025-04-16T12:19:10Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-dev-lgpl-aarch64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900000", "id": 246900000, "node_id": "RA_kwDOGJR1V84Ot2Ug", "name": "mpv-dev-lgpl-x86_64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 25450009, "download_count": 1, "created_at": "2025-04-16T12:19:08Z", "updated_at": "2025-04-16T12:19:09Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-dev-lgpl-x86_64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246899994", "id": 246899994, "node_id": "RA_kwDOGJR1V84Ot2Ua", "name": "mpv-dev-lgpl-x86_64-v3-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 26598979, "download_count": 1, "created_at": "2025-04-16T12:19:07Z", "updated_at": "2025-04-16T12:19:08Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-dev-lgpl-x86_64-v3-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246899980", "id": 246899980, "node_id": "RA_kwDOGJR1V84Ot2UM", "name": "mpv-dev-x86_64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 29368930, "download_count": 4, "created_at": "2025-04-16T12:19:05Z", "updated_at": "2025-04-16T12:19:06Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-dev-x86_64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246899974", "id": 246899974, "node_id": "RA_kwDOGJR1V84Ot2UG", "name": "mpv-dev-x86_64-v3-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 30676970, "download_count": 5, "created_at": "2025-04-16T12:19:04Z", "updated_at": "2025-04-16T12:19:05Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-dev-x86_64-v3-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246899967", "id": 246899967, "node_id": "RA_kwDOGJR1V84Ot2T_", "name": "mpv-x86_64-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 30339112, "download_count": 201, "created_at": "2025-04-16T12:19:03Z", "updated_at": "2025-04-16T12:19:04Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-x86_64-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246899958", "id": 246899958, "node_id": "RA_kwDOGJR1V84Ot2T2", "name": "mpv-x86_64-v3-20250416-git-4697f7c.7z", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 31642920, "download_count": 98, "created_at": "2025-04-16T12:19:02Z", "updated_at": "2025-04-16T12:19:03Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-x86_64-v3-20250416-git-4697f7c.7z" }, { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/assets/246900101", "id": 246900101, "node_id": "RA_kwDOGJR1V84Ot2WF", "name": "sha256.txt", "label": "", "uploader": { "login": "github-actions[bot]", "id": 41898282, "node_id": "MDM6Qm90NDE4OTgyODI=", "avatar_url": "https://avatars.githubusercontent.com/in/15368?v=4", "gravatar_id": "", "url": "https://api.github.com/users/github-actions%5Bbot%5D", "html_url": "https://github.com/apps/github-actions", "followers_url": "https://api.github.com/users/github-actions%5Bbot%5D/followers", "following_url": "https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/github-actions%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/github-actions%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/github-actions%5Bbot%5D/repos", "events_url": "https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/github-actions%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false }, "content_type": "raw", "state": "uploaded", "size": 1871, "download_count": 6, "created_at": "2025-04-16T12:19:22Z", "updated_at": "2025-04-16T12:19:22Z", "browser_download_url": "https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/sha256.txt" } ], "tarball_url": "https://api.github.com/repos/zhongfly/mpv-winbuild/tarball/2025-04-16-4697f7c", "zipball_url": "https://api.github.com/repos/zhongfly/mpv-winbuild/zipball/2025-04-16-4697f7c", "body": "**MPV Git commit**: https://github.com/mpv-player/mpv/commit/4697f7cb86c2e39175276ae5586f37da96f3a135\n**Build Time**: 2025-04-16 12:18\n**Compiler**: clang\n**Build Details**: https://github.com/zhongfly/mpv-winbuild/actions/runs/14492161585\n**Download Tips:**\n[mpv-x86_64-20250416-git-4697f7c.7z](https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-x86_64-20250416-git-4697f7c.7z): for 64 bit system\n[mpv-x86_64-v3-20250416-git-4697f7c.7z](https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-x86_64-v3-20250416-git-4697f7c.7z): for 64 bit system with cpu not older than Intel Haswell or AMD Excavator\n[mpv-aarch64-20250416-git-4697f7c.7z](https://github.com/zhongfly/mpv-winbuild/releases/download/2025-04-16-4697f7c/mpv-aarch64-20250416-git-4697f7c.7z): for ARM64(aarch64)\n**Downloads**: ![downloads](https://badgen.net/github/assets-dl/zhongfly/mpv-winbuild/2025-04-16-4697f7c?cache=300)", "reactions": { "url": "https://api.github.com/repos/zhongfly/mpv-winbuild/releases/212788193/reactions", "total_count": 1, "+1": 1, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0 } }'

# Use jq to parse the JSON to extract important information
NEWREV=$(echo "$APIRESPONSE" | "$jqpath" -r '.tag_name')
NEWREVDATE=${NEWREV:0:10}
NEWREVGIT=${NEWREV:11}
NEWFILENAMESTD=$(echo "$APIRESPONSE" | "$jqpath" -r ".assets[].name | select(startswith(\"mpv-dev-x86_64-${NEWREVDATE//-/}\"))")
NEWFILENAMEARM=$(echo "$APIRESPONSE" | "$jqpath" -r ".assets[].name | select(startswith(\"mpv-dev-aarch64-${NEWREVDATE//-/}\"))")

# Use the new revision and the new file name to replace the old revision and file name in vendor scripts
if [ "$OLDREV" == "$NEWREV" ]; then
    echo "Already up to date"
    exit 0
fi
echo "Updating links from $OLDREV to $NEWREV"
echo "  - $OLDFILENAMESTD -> $NEWFILENAMESTD"
echo "  - $OLDFILENAMEARM -> $NEWFILENAMEARM"
find "$ROOTDIR/vnd" -type f -name "vendor*" -exec sed -i "s/$OLDREV/$NEWREV/g" "{}" \;
find "$ROOTDIR/vnd" -type f -name "vendor*" -exec sed -i "s/$OLDFILENAMESTD/$NEWFILENAMESTD/g" "{}" \;
find "$ROOTDIR/vnd" -type f -name "vendor*" -exec sed -i "s/$OLDFILENAMEARM/$NEWFILENAMEARM/g" "{}" \;
